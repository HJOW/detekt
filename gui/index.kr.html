<html>
<head>
<link rel="stylesheet" href="static/css/bootstrap.min.css">
<link rel="stylesheet" href="static/css/bootflat.min.css">
% if action == 'running':
    <meta http-equiv="refresh" content="5; URL=/check">
% end
</head>
<body style="background-color: #f1f2f6;">
    <div class="container-fluid">
        <div class="row">
            <div class="well">
                <img src="static/logo.png" />
            </div>
        </div>

        % if action == 'start':
            % include('languages.html', language=language)

            % if connection:
                <div class="alert alert-warning"><strong>경고 !</strong> 인터넷에 연결되어 있습니다. 이 테스트를 할 동안 유선과 무선 연결을 해제해 주세요.</div>
            % end

            <div class="panel panel-default">
                <div class="panel-heading">
                    <h3 class="panel-title"><strong>이 프로그램은?</strong></h3>
                </div>
                <div class="panel-body">
                    이 간단한 프로그램은 당신의 컴퓨터에 잠재적인 스파이웨어가 존재하는 지 검사합니다.
                    실행되면, 메모리 상에 특정 스파이웨어 징후가 있는지 검사합니다. 다음과 같은 프로그램이 실행되고 있다면 (각종 브라우저와 메신저 프로그램 등) 해당 프로그램들을 종료하여야 테스트 속도를 높이고 오진을 줄일 수 있습니다. 검사는 몇 분 정도 소요됩니다.
                    관리자 권한으로 실행되어야 검사가 가능합니다.
                </div>
            </div>

            <p>
                <a class="btn btn-lg btn-primary btn-block" href="/scan">지금 검사</a>
            </p>
        % end

        % if action == 'running':
            <div class="panel panel-default">
                <div class="panel-heading">
                    <h3 class="panel-title"><strong>검사 중...</strong></h3>
                </div>
                <div class="panel-body">
                    <p>검사 중입니다. 검사에는 몇 분이 소요됩니다. 검사가 끝나면 결과가 표시됩니다. 인내심을 가지고 기다려 주세요.
                    <div class="progress progress-striped active">
                        <div class="progress-bar" role="progressbar" aria-valuenow="100" aria-valuemin="0" aria-valuemax="100" style="width: 100%"></div>
                    </div>
                    <p style="text-align: center;"><a href="/check">새로고침</a><br /><small>5초마다 자동으로 새로고침됩니다.</small></p>
                </div>
            </div>
        % end

        % if action == 'results':
            % if errors:
                <div class="alert alert-warning">
                    <h4>WARNING!</h4>
                    <strong>오류</strong> 가 발생하여 검사를 수행하지 못했습니다 :
                    <ul>
                        % for error in errors:
                            % if error == 'NOT_AN_ADMIN':
                                <li>관리자 권한으로 실행해야 검사가 가능합니다.</li>
                            % elif error == 'UNSUPPORTED_WINDOWS':
                                <li>지원되지 않는 버전의 Windows 를 사용하고 있습니다.</li>
                            % elif error == 'NO_DRIVER':
                                <li>사용 가능한 드라이버를 찾을 수 없었습니다.</li>
                            % elif error == 'SERVICE_NO_START':
                                <li>서비스를 시작하지 못했습니다. 시스템을 다시 시작해 보세요.</li>
                            % elif error == 'SCAN_FAILED':
                                <li>스캔에 실패하였습니다. 홈페이지에 접속하여 이 문제를 보내주세요.</li>
                            % end
                        % end
                    </ul>
                </div>
            % else:
                % if infected:
                    <div class="alert alert-danger">
                        <h4>경고 !</h4>
                        <p><strong>잠재적인 스파이웨어를 발견했습니다.</strong>
                        <p>오진일 가능성이 있으므로, 생성된 <b>detekt.log</b> 파일을 저희에게 보내주세요.</p>
                        <p>감염이 확실하다면, 인터넷 연결을 즉시 차단하시고, 전문가에게 의뢰해 주세요.</p>
                        이 홈페이지에서 저희에게 문의할 수 있으며 감염 시 도움을 받을 수 있습니다 : <b>https://www.resistsurveillance.org/emergency</b>
                    </div>

                    <p>이 검사가 발견한 이슈입니다.</p>
                    <ul>
                        % for detection in results:
                            <li><strong>{{detection}}</strong><br />
                            % if detection == 'BlackShades RAT':
                                이 것은 인터넷 상에서 쉽게 다운로드될 수 있는 일반적인 트로이목마입니다. 이 것은 일반적인 백신 프로그램에 의해 감지되는 것이 보통입니다. 누가 당신을 노리고 있는지는 모르겠지만, 도움을 받으셔야 합니다.
                            
                            % elif detection == 'DarkComet RAT':
                                이 것은 인터넷 상에서 쉽게 다운로드될 수 있는 일반적인 트로이목마입니다. 이 것은 일반적인 백신 프로그램에 의해 감지되는 것이 보통입니다. 누가 당신을 노리고 있는지는 모르겠지만, 도움을 받으셔야 합니다.

                            % elif detection == 'FinFisher FinSpy':
                                이 것은 독일에서 제작되어 전 세계 정부 기관에 판매되는 백도어 스파이입니다. 정부 혹은 해외 정부의 감시를 받고 있는 것 같습니다. 다음 행동을 주의하세요. 당신에게 위협으로 돌아올 수 있습니다.

                            % elif detection == 'Gh0st':
                                이 것은 인터넷 상에서 쉽게 다운로드될 수 있는 일반적인 트로이목마입니다. 이 것은 일반적인 백신 프로그램에 의해 감지되는 것이 보통입니다. 누가 당신을 노리고 있는지는 모르겠지만, 도움을 받으셔야 합니다.

                            % elif detection == 'Njrat':
                                이 것은 인터넷 상에서 쉽게 다운로드될 수 있는 일반적인 트로이목마입니다. 이 것은 일반적인 백신 프로그램에 의해 감지되는 것이 보통입니다. 누가 당신을 노리고 있는지는 모르겠지만, 도움을 받으셔야 합니다.

                            % elif detection == 'Hacking Team RCS Scout' or detection == 'Hacking Team RCS Backdoor':
                                이 것은 이탈리아에서 제작되어 전 세계 정부 기관에 판매되는 백도어 스파이입니다. 정부 혹은 해외 정부의 감시를 받고 있는 것 같습니다. 다음 행동을 주의하세요. 당신에게 위협으로 돌아올 수 있습니다.

                            % elif detection == 'ShadowTech RAT':
                                이 것은 인터넷 상에서 쉽게 다운로드될 수 있는 일반적인 트로이목마입니다. 이 것은 일반적인 백신 프로그램에 의해 감지되는 것이 보통입니다. 누가 당신을 노리고 있는지는 모르겠지만, 도움을 받으셔야 합니다.

                            % elif detection == 'Xtreme RAT':
                                이 것은 인터넷 상에서 쉽게 다운로드될 수 있는 일반적인 트로이목마입니다. 이 것은 일반적인 백신 프로그램에 의해 감지되는 것이 보통입니다. 누가 당신을 노리고 있는지는 모르겠지만, 도움을 받으셔야 합니다.

                            % end
                            </li>
                        % end
                    </ul>
                % else:
                    <div class="alert alert-success">
                        <h4>감염 발견 안 됨</h4>
                        <p>이 검사는 국가가 운영하는 스파이웨어 소프트웨어 등을 발견하지는 못합니다. 이 검사 결과만으로 안전하다고 판단하지는 못합니다. Detekt 검사가 아직 발견하지 못하는 스파이웨어가 있을 수도 있습니다. 백신 프로그램으로 시스템을 검사해 보세요.</p>
                        <p>백신 및 보안 프로그램을 최신 버전으로 업데이트하여 사용해 주세요. 최선의 방어는 디지털 위생을 지키고(일반 사용자 계정 사용, 비밀번호 사용 등) 정품을 사용하는 것입니다.</p>
                        <p>이 검사 결과가 있더라도 아주 의심되는 스파이웨어가 있다면 저희에게 문의해 주세요.</p>
                        앞으로 어떻게 해야 되는지에 대한 도움을 <b>https://www.resistsurveillance.org/emergency</b> 에서 받으실 수 있습니다.
                    </div>
                % end
            % end
        % end
    </div>
</body>
</html>
